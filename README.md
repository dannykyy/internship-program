# internship-program
# 多模态特征融合的新冠肺炎阳性率预测方法

本项目旨在通过深度学习方法，利用多模态特征融合技术，解决美国新冠疫情阳性率的预测问题。我们构建了一个融合循环神经网络（RNN）与全连接神经网络（FCNN）的深度学习模型，以捕捉时序动态性和融合静态特征，从而实现对各州未来阳性率的精准预测。

## 目录
- [项目背景](#项目背景)
- [项目目标](#项目目标)
- [问题陈述](#问题陈述)
- [方法与技术栈](#方法与技术栈)
- [数据集](#数据集)
- [模型架构](#模型架构)
- [模型训练与优化](#模型训练与优化)
- [性能评估](#性能评估)
- [使用方法](#使用方法)
- [团队成员](#团队成员)

## 项目背景

新型冠状病毒（COVID-19）的全球大流行对公共卫生体系和社会经济秩序造成了深远影响。阳性率作为关键指标，能反映病毒传播趋势，并指导检测资源分配、防控政策调整及医疗系统预警。传统统计模型难以充分捕捉疫情数据的复杂时空动态性及多源异构特征（如人口流动、疫苗接种、政策干预等），因此需要更合适的深度学习模型来更好地掌握疫情信息。

## 项目目标

通过深度学习方法，实现一个高效的模型，利用多维度历史数据和已知非阳性率特征，预测美国各州的新冠肺炎阳性率。

## 问题陈述

基于美国各州前四天的多维度历史数据（包括检测量、住院数、疫苗接种率、人口流动指数等），结合第五天已知的非阳性率特征，构建机器学习模型以预测第五天的州级阳性率。本研究通过循环神经网络（RNN）+全连接神经网络（FCNN）模型进行分析，并与简单RNN、深层神经网络模型（DNN）对比，以期在降低模型训练成本和复杂度的同时获得良好的预测结果。

## 方法与技术栈

* **平台：** Google Colab, Visual Studio Code
* **框架：** PyTorch
* **核心技术：** 循环神经网络 (RNN), 全连接神经网络 (FCNN), 注意力机制 (Attention Mechanism), 多模态特征融合。
* **优化：** AdamW 优化器, ReduceLROnPlateau 学习率调度, 梯度裁剪, 早停机制。
* **超参数调优：** Optuna 框架（用于贝叶斯优化）。

## 数据集

我们从 [Kaggle](https://www.kaggle.com/datasets/gbonte/covid19-cases-prediction) 下载了数据集，其中包含了美国37个州过去五天的新冠疫情调查结果。数据以 `csv` 文件形式存储，主要特征包括：

| 特征                         | 含义                                 |
| :--------------------------- | :----------------------------------- |
| AL~WA                        | 美国各州缩写                         |
| cli、ili                     | COVID 样疾病、流感样疾病             |
| hh\_cmnty\_cli、nohh\_cmnty\_cli | 社区报告病例（包括/不包括家庭）      |
| wearing\_mask                | 戴口罩                               |
| travel\_outside\_state、work\_outside\_home | 外出旅行、非居家办公                 |
| shop、restaurant             | 购物、去餐馆                         |
| spent\_time                  | 与他人共度时间                       |
| large\_event                 | 参加大型活动                         |
| public\_transit              | 使用公共交通                         |
| anxious、depressed、worried\_finances | 焦虑、压力、担心财务状况             |
| tested\_positive             | COVID-19 检测呈阳性 (目标变量)       |

**数据预处理：**
* **数据集分割：** 原始数据按70%训练集、15%验证集、15%测试集进行顺序分割。
* **特征与目标变量分离：** 提取第五天的 `tested_positive` 作为目标变量。
* **静态特征构建：** 将前37列（地理区域编码）作为静态特征。
* **时间序列数据构建：** 将第38列后的所有特征重塑为 `(样本数 × 时间步数 × 每天特征数)` 的三维张量。
* **数据归一化：** 对时间序列数据和静态特征分别进行 Min-Max 归一化。

## 模型架构

我们构建了一个融合时间序列和静态特征的 COVID-19 阳性率预测模型。

![模型结构图](README_Model_Architecture.png) **核心组件：**
1.  **时间序列处理分支：** 使用单层 RNN（或 LSTM/GRU）处理前四天多维度时序数据，提取最后一个时间步的隐藏状态作为序列的概括表示。
2.  **静态特征处理分支：** 使用全连接网络将原始静态特征映射到与 RNN 输出相同的维度，以实现特征对齐。
3.  **双通道注意力机制（AttentionModule）：** 学习时间序列特征和静态特征的重要性权重，并根据这些权重动态融合两者。
4.  **特征融合：** 将加权后的时间序列特征和静态特征进行拼接，形成一个包含时序动态和静态空间信息的融合特征向量。
5.  **预测层：** 融合特征通过一个多层全连接网络，最终输出第五天的阳性率预测值。

## 模型训练与优化

* **损失函数：** 均方误差 (MSELoss)。
* **优化器：** AdamW，配合权重衰减进行正则化。
* **学习率调度：** ReduceLROnPlateau，根据验证损失动态调整学习率。
* **正则化：** 梯度裁剪（防止梯度爆炸），早停机制（防止过拟合）。
* **超参数调优：** 利用 Optuna 框架进行贝叶斯优化，以寻找最优的 RNN 隐藏层维度、层数、全连接层维度、学习率和批量大小等超参数。

## 性能评估

我们使用以下指标评估模型性能：
* **均方误差 (MSE)**
* **平均绝对误差 (MAE)**
* **平均绝对百分比误差 (MAPE)**
* **决定系数 (R²)**

模型将与朴素预测法（NF）、加权滑动平均法（WMA）、简单RNN和深层神经网络（DNN）等基准模型进行对比，以验证多模态特征融合方法的有效性。

## 使用方法

1.  **克隆仓库：**
    ```bash
    git clone [https://github.com/YourUsername/YourRepoName.git](https://github.com/YourUsername/YourRepoName.git)
    cd YourRepoName
    ```

2.  **安装依赖：**
    ```bash
    pip install -r requirements.txt # 如果有requirements.txt文件
    # 否则，手动安装以下库：
    pip install torch numpy pandas matplotlib tqdm gradio
    ```

3.  **下载数据集：**
    从 [Kaggle COVID-19 Cases Prediction](https://www.kaggle.com/datasets/gbonte/covid19-cases-prediction) 下载数据集，并将其放置在项目根目录下的 `data` 文件夹中（例如 `data/your_dataset_file.csv`）。

4.  **运行训练：**
    `RNN新冠预测+简化网络+隐藏层对齐+测试集顺序划分.py` 包含了模型的定义、数据预处理和训练逻辑。可以直接运行此文件进行模型训练和评估。

    ```bash
    python "RNN新冠预测+简化网络+隐藏层对齐+测试集顺序划分.py"
    ```

5.  **运行 Gradio 应用 (可选)：**
    `app.py` 提供了一个基于 Gradio 的交互式界面，可以用于实时查看训练过程和模型性能。

    ```bash
    python app.py
    ```
    运行后，复制输出的本地URL（通常是 `http://127.0.0.1:7860` 或其他端口）到浏览器中访问。


